<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" href="/images/cabin.png">
    <link href="/styles/main.css" rel="stylesheet">
    <title>Backbone.Collection View</title>
  </head>
  <body>
    <ul class="nav group">
      <li class="icon-menu menu"></li>
      <li class="nav-link red"><a href="/" class="name">Colin Wren</a></li>
      <li class="nav-link blue"><a href="/about.html">about</a></li>
      <li class="nav-link green"><a href="/archives.html">archives</a></li>
    </ul>
    <div class="content">
      <div class="post">
        <div class="post-head group"><a href="/posts/backbone-collection-view/">
            <h1 class="post-title">Backbone.Collection View</h1></a>
          <h2 class="post-date">Published  May 15, 2013</h2>
        </div>
        <div class="post-body markdown"><p>Backbone classes that are used to render views and manage events for a
collection of models are common. They all render model
views, listen to a collection for events, and have assorted methods to manage
model views. These classes tend to be one of the largest sources of non-<a href="http://en.wikipedia.org/wiki/Don&#39;t_repeat_yourself">DRY</a> code
in Backbone apps. Thats why having a solid base class for these views like
Backbone.CollectionView is indispensable.</p>
<p><a href="http://rotundasoftware.github.io/backbone.collectionView/">Backbone.CollectionView</a>
extends Backbone&#39;s view class, it adds default functionality and options that make
it much easier to create awesome user experiences while keeping your code DRY. I&#39;ll go
over some of its features and compare some code using Backbone.CollectionView
to the equivalent implementation in vanilla Backbone. Check out the <a href="http://rotundasoftware.github.io/backbone.collectionView/">demo page</a>
for examples along with the code used to implement them.</p>
<h2><a name="features"class="anchor" href="#features"><span class="header-link"></span></a>Features</h2>
<h3><a name="automatic-model-view-rendering"class="anchor" href="#automatic-model-view-rendering"><span class="header-link"></span></a>Automatic model view rendering</h3>
<p>When initialized, a view that inherits from Backbone.CollectionView will automatically render a view for
each model in the provided collection. It will also start listening
to its collection to ensure that the model views are re-rendered correctly when the
collection changes.</p>
<h3><a name="selectable"class="anchor" href="#selectable"><span class="header-link"></span></a>Selectable</h3>
<p>Backbone.CollectionView provides
a very nice way to create a list of selectable items through its <code>selectable</code> option. The default
behavior is to have models be selected when their corresponding view is clicked.
By default, only one model is selectable at a time, if you want to give users
the ability to select multiple models there is the <code>selectMultiple</code> option.</p>
<p>Along with making it easy to provide a user interface for selecting models,
Backbone.CollectionView exposes an intuitive API for managing model selection.
Whenever the selection is changed the view fires a <code>selectionChanged</code> event
that passes the new and old models to the handler. The view has necessary methods like
<code>getSelectedModels</code> and <code>setSelectedModel</code> which are self explanatory. You
can <code>get</code> and <code>set</code> by the <code>data-id</code>, <code>cid</code>, <code>offset</code> (index of model view in all
visible model views), and by the <code>view</code> that the model is attached to.</p>
<h3><a name="sortable"class="anchor" href="#sortable"><span class="header-link"></span></a>Sortable</h3>
<p>Backbone.CollectionView also provides a <code>sortable</code> option which uses jQuery
UI&#39;s <a href="http://jqueryui.com/sortable/">sortable interaction</a> to enable drag and
drop sorting on your model views, if you haven&#39;t checked it out I highly
recommend doing so. It provides a powerful API for managing drag and drop sorting
(something that requires a ton of code to implement by hand) and is reliable as
anything you would expect to come out of the jQuery project. It&#39;s great to be able
to utilize this interaction seamlessly though Backbone.CollectionView.</p>
<h2><a name="comparison"class="anchor" href="#comparison"><span class="header-link"></span></a>Comparison</h2>
<p>It is often the case that you need a class that manages the rendering of a view
for each model in its collection. The examples below are of classes that provide this
functionality, the first inherits from the Backbone base view class
and the second inherits from the Backbone.CollectionView class. I also added
functionality to add a model (and its corresponding view) to the collection to
show that the class that inherits from Backbone.CollectionView listens to its collection and handles the
re-rendering for you.</p>
<h3><a name="inheriting-from-backbone-view"class="anchor" href="#inheriting-from-backbone-view"><span class="header-link"></span></a>Inheriting from Backbone.View</h3>
<pre><code class="lang-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">TodosView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
  <span class="nx">el</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#todo-container&#39;</span><span class="p">),</span>

  <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;click #create-todo&#39;</span><span class="o">:</span> <span class="s1">&#39;createTodo&#39;</span>
  <span class="p">},</span>

  <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">collection</span><span class="o">:</span> <span class="k">new</span> <span class="nx">TodosCollection</span><span class="p">(),</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">,</span> <span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">addOne</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
  <span class="p">},</span>

  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">addAll</span><span class="p">();</span>
  <span class="p">},</span>

  <span class="nx">addAll</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#todo-list&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">addOne</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">addOne</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TodoView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span> <span class="nx">todo</span><span class="p">});</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#todo-list&#39;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="nx">createTodo</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;newTodo&#39;</span><span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</code></pre>
<h3><a name="inheriting-from-backbone-collectionview"class="anchor" href="#inheriting-from-backbone-collectionview"><span class="header-link"></span></a>Inheriting from Backbone.CollectionView</h3>
<pre><code class="lang-javascript"><div class="highlight"><pre> <span class="kd">var</span> <span class="nx">TodosView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">CollectionView</span><span class="p">({</span>
  <span class="nx">el</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#todo-container&#39;</span><span class="p">),</span>
  <span class="nx">collection</span><span class="o">:</span> <span class="k">new</span> <span class="nx">TodosCollection</span><span class="p">(),</span>
  <span class="nx">modelView</span><span class="o">:</span> <span class="nx">TodoView</span><span class="p">,</span>

  <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;click #create-todo&#39;</span><span class="o">:</span> <span class="s1">&#39;createTodo&#39;</span>
  <span class="p">},</span>

  <span class="nx">createTodo</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">add</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;newTodo&#39;</span><span class="p">});</span>
  <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</code></pre>
</div>
        <!-- Social sharing icons-->
        <div class="social"><a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
          <div data-size="medium" data-annotation="bubble" data-width="300" class="g-plusone"></div><a href="http://news.ycombinator.com/submit" class="hn-share-button">Vote on HN</a>
        </div>
        <!-- Disqus comments, Make sure to replace `colinwren` with your account name in-->
        <!-- the Disqus helper script below-->
        <div id="comments">
          <div id="disqus_thread"></div>
        </div>
        <!-- Helper scripts for social share icons-->
        <!-- Hacker News-->
        <script>
          (function(d, t) {
            var g = d.createElement(t),
                s = d.getElementsByTagName(t)[0];
            g.src = '//hnbutton.appspot.com/static/hn.min.js';
            s.parentNode.insertBefore(g, s);
          }(document, 'script'));
          
        </script>
        <!-- Twitter-->
        <script>
          !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
          
        </script>
        <!-- Google plus-->
        <script>
          (function() {
            var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
            po.src = 'https://apis.google.com/js/plusone.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
          })();
          
        </script>
        <!-- Disqus-->
        <script>
          var disqus_shortname = 'colinwren'; // Change this to your Disqus account name
          
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
      </div>
    </div><a href="http://cabinjs.com"><img src="/images/cabin.png" class="cabin"></a>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.2/jquery.min.js" type="text/javascript"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-timeago/1.1.0/jquery.timeago.min.js" type="text/javascript"></script>
    <script src="/scripts/main.js" type="text/javascript"></script>
    <script>// Add your analytics code here</script>
  </body>
</html>